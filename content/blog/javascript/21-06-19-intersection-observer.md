---
title: '[JS] ì•Œì•„ë‘ë©´ ì“¸ë°ìˆëŠ” ğŸ”­Intersection Observer'
date: 2021-06-19 20:06:04
category: javascript
thumbnail: './images/21-06-19/undraw_Contrast_re_hc7k.png'
draft: false
---

![thumbnail](./images/21-06-19/undraw_Contrast_re_hc7k.png)

## 0. Intersection Observer ë¥¼ í•´ì„í•œë‹¤ë©´

`Intersection Observer`ì˜ ì—­í• ì„ ì•Œê¸° ì „ì— ëœ»ì„ ë¨¼ì € ì•Œê³  ê°€ë³´ëŠ” ê±´ ì–´ë– ì‹¤ê¹Œìš”?

- **Intersection**ì€ _Inter + section_ ìœ¼ë¡œ, **'êµì°¨ë¡œ', 'ì„œë¡œ ë§Œë‚˜ëŠ” ì§€ì '** ì„ ëœ»í•©ë‹ˆë‹¤.

- **Observer**ëŠ” ë‹¤ë“¤ ì•„ì‹œë‹¤ì‹œí”¼ **'ê°ì‹œì'** ì˜ ëœ»ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ~~ìŠ¤íƒ€í¬ë˜í”„íŠ¸ ë•ë¶„~~

ê·¸ëŸ¼ ì´ ë‘˜ì„ í•©ì¹˜ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”?

**êµì°¨ì§€ì  ê°ì‹œì** ì •ë„ê°€ ì–´ìš¸ë¦¬ë„¤ìš”!

> ì–´ë•Œìš”? ë­í•˜ëŠ” ì¹œêµ¬ì¸ì§€ ëŠë‚Œì´ ì˜¤ì£ ?

## 1. ì—­í• 

`Intersection Observer`, ì¦‰ êµì°¨ì§€ì ì„ ê°ì‹œí•˜ëŠ” ì´ `api`ëŠ” **íŠ¹ì •í•œ ë·°í¬íŠ¸ë‚´ì—ì„œ ìš”ì†Œê°€ êµì°¨ì§€ì ì„ ì§€ë‚˜ëŠ”ì§€ ê°ì‹œí•˜ëŠ” ì—­í• **ì„ í•´ì£¼ëŠ” í¸ë¦¬í•œ ë°©ë²•ì„ ì œê³µí•´ì¤ë‹ˆë‹¤.

ì—¬ê¸°ì„œ íŠ¹ì •í•œ ë·°í¬íŠ¸ëŠ” **ìš°ë¦¬ê°€ ë³´ëŠ” ë¬¸ì„œì˜ í…Œë‘ë¦¬**ê°€ ë  ìˆ˜ë„ ìˆê³ , **íŠ¹ì •í•œ ìš”ì†Œ**ê°€ ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

![ê¸°ìƒì¶©-ì„ ë„˜ëŠ”](./images/21-06-19/ê¸°ìƒì¶©ì„ ë„˜ë„¤.gif)

ìœ ëª…í•œ ì˜í™”ì¸ ê¸°ìƒì¶©ì˜ í•œ ì¥ë©´ì²˜ëŸ¼
ì´ë ‡ê²Œ ê´€ë¦¬ì¸ì´(ìš”ì†Œê°€) ì„ ì„(ë·°í¬íŠ¸ì˜ í…Œë‘ë¦¬ë¥¼) ë„˜ëŠ” ëª¨ìŠµì„ ë°”ë¼ë³´ëŠ” ê¸°ìš°ê°€ ë°”ë¡œ `Intersection Observer`ì¸ ê²ƒì…ë‹ˆë‹¤!

ì´ë ‡ê²Œ `Intersection Observer`ëŠ” ëª…ë ¹ëŒ€ë¡œ ì˜ ê°ì‹œí•˜ê³  ìˆë‹¤ê°€ **ì„ ì„ ë„˜ëŠ” ìˆœê°„** ìš°ë¦¬ì—ê²Œ ì•Œë ¤ì£¼ëŠ” ê²ƒì´ì£ .

> ì´ì „ì—ëŠ” `scrollHeight`ë‘ `scrollTop` ê°™ì€ ê²ƒë“¤ì„ ì¡°í•©í•´ì„œ `scroll` ì´ë²¤íŠ¸ì— ë“±ë¡ì‹œì¼œ ê³„ì‚°í–ˆì—ˆëŠ”ë°, ì´ì   ê·¸ëŸ° ê³ ìƒì€ í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤!

> ê²Œë‹¤ê°€ `scroll` ì´ë²¤íŠ¸ì˜ ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ì„  `throttle` ê°™ì€ ê²ƒë„ ê³ ë ¤ë¥¼...

![ì„ ë„˜ë„¤](images/21-06-19/ë‘˜ë¦¬ì„ ë„˜ë„¤.jpg)

## 2. ì‚¬ìš©í•˜ê¸°

ê·¸ëŸ¼ ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë´…ì‹œë‹¤.

> ì‚¬ì‹¤ ì´ ì½”ë“œ ë¸”ëŸ­ í•˜ë‚˜ë©´ ì„¤ëª…ì´ ëë‚œ ê±°ë‚˜ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤.

```js
const intersectionObserver = new IntersectionObserver((entries, observer) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      // ì„  ë„˜ë„¤...
      observer.unobserve(entry.target) // í•„ìš”í•œ ê²½ìš° ê°ì‹œ ëŒ€ìƒì—ì„œ ì œì™¸
    }
  })
})

intersectionObserver.observe(element) // ê°ì‹œí•  ìš”ì†Œë¥¼ ë“±ë¡í•´ì¤ë‹ˆë‹¤
```

### í•œ ì¤„ ì”© ì°¨ê·¼ì°¨ê·¼

1.  ```js
    let observer = new IntersectionObserver(callback, options)
    ```

    ë¨¼ì € ì´ë ‡ê²Œ `IntersectionObserver`ë¥¼ ì„ ì–¸í•´ì¤ë‹ˆë‹¤.
    ë³´ì´ëŠ”ëŒ€ë¡œ **ì½œë°± í•¨ìˆ˜ì™€ ì˜µì…˜**ì„ ë„˜ê²¨ì¤˜ì•¼ í•©ë‹ˆë‹¤.

2.  ```js
    let callback = (entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          // ì´ ì•ˆì˜ entryëŠ” ì„ ì„ ë„˜ëŠ” ìš”ì†Œë“¤ì„ ëœ»í•©ë‹ˆë‹¤.
          console.log(`${entry.target}ì´ ì„ ì„ ë„˜ì–´ ë·°í¬íŠ¸ ë‚´ë¡œ ë“¤ì–´ì™”ì–´ìš”!`)
          observer.unobserve(entry.target) // ì´ë²¤íŠ¸ì—ì„œ ë²—ì–´ë‚˜ë ¤ë©´ í˜¸ì¶œí•˜ì„¸ìš”
        }
      })
    }
    ```

    ë„˜ê²¨ì¤„ ì½œë°± í•¨ìˆ˜ì˜ `entries`ëŠ” **ê°ì‹œ ëŒ€ìƒì´ ëœ ìš”ì†Œë“¤**ì„ ëœ»í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  `.isIntersecting`, ì¦‰ **ì„ ì„ ë„˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê³¼ì •**ì„ ê±°ì¹©ë‹ˆë‹¤.
    ë§Œì•½ ì´ë²¤íŠ¸ë¥¼ í•œ ë²ˆë§Œ ë°œìƒì‹œí‚¬ ê±°ë©´ `.unobserve`ë¥¼ í•´ì„œ ì´ë²¤íŠ¸ë¥¼ í•´ì œí•´ì¤ì‹œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì„ ì„ ë„˜ì„ ë•Œë§ˆë‹¤ ê³„ì† ì´ë²¤íŠ¸ê°€ ë°œìƒí•´ìš”!

3.  ```js
    observer.observe(element)
    ```

    ë§ˆì§€ë§‰ìœ¼ë¡œ **ê°ì‹œë¥¼ ì›í•˜ëŠ” ìš”ì†Œ**ë¥¼ `.observe`ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ë„˜ê²¨ì£¼ë©´ ëì…ë‹ˆë‹¤!

### ì˜µì…˜ì„ ë¶™ì—¬ë³´ì

```js
let options = {
  root: document.querySelector('#scrollArea'),
  rootMargin: '0px',
  threshold: 1.0,
}
```

ìƒì„±ìì˜ ë‘ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì¸ optionsì…ë‹ˆë‹¤.

1. `root`ëŠ” ë§ ê·¸ëŒ€ë¡œ **ë£¨íŠ¸ê°€ ë˜ëŠ” ìš”ì†Œë¥¼ ì„¤ì •**í•©ë‹ˆë‹¤. ìœ„ì—ì„œ ë§í–ˆë“¯ì´ ë·°í¬íŠ¸ê°€ ê¼­ ë¬¸ì„œ ì „ì²´(`body`)ë¥¼ ëœ»í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.

2. `rootMargin`ì€ ìœ„ì˜ `root`ê°€ ê°€ì§„ ì—¬ë°±ì…ë‹ˆë‹¤. ì´ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ë·°í¬íŠ¸ì— ë‚˜íƒ€ë‚˜ê¸° ëª‡ í”½ì…€ ì „ì— **ë¯¸ë¦¬ ì´ë²¤íŠ¸ë¥¼ í™œì„±í™”**ì‹œí‚¤ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. `lazy loading` ê°™ì€ ê²ƒì— ì“°ê¸° ì¢‹ê² ë„¤ìš”.

3. `threshold`ëŠ” ê°ì‹œ ëŒ€ìƒì´ **ì–¼ë§Œí¼ ë³´ì—¬ì•¼ ì´ë²¤íŠ¸ë¥¼ í™œì„±í™”**ì‹œí‚¬ì§€ ê²°ì •í•˜ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤. 1ë¡œ ì„¤ì •í•˜ë©´ ìš”ì†Œì˜ ëª¨ë“  ë¶€ë¶„ì´ ë‹¤ ë³´ì—¬ì•¼ ì´ë²¤íŠ¸ê°€ í™œì„±í™”ë©ë‹ˆë‹¤.

> ì´ë ‡ê²Œ í•˜ë©´ `Intersection Observer`ê°€ **ì§€ê¸ˆ ì„ ì„ ë„˜ì–´ì„œ ìš°ë¦¬ê°€ ë³¼ ìˆ˜ ìˆëŠ” ê³³ì— ë‹¿ê³  ìˆìŠµë‹ˆë‹¤!** ë¼ê³  ìš°ë¦¬ì—ê²Œ ì¹œì ˆíˆ ì•Œë ¤ì¤ë‹ˆë‹¤!

![ì„ ì„ë„˜ëŠ”](images/21-06-19/ì„ ì„ë„˜ëŠ”.jpg)

## 3. ì‚¬ìš©ì²˜

ë§‰ ì–¸ê¸‰í–ˆë‹¤ì‹œí”¼ `lazy loading` ê°™ì€ ê³³ì— ì£¼ë¡œ ì“°ì…ë‹ˆë‹¤. ì²˜ìŒë¶€í„° ì „ë¶€ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šê³ , í•„ìš”í•œ ë¶€ë¶„ë§Œ ì›í•  ë•Œë§ˆë‹¤ ë¶€ë¥¼ë•Œ ìœ ìš©í•˜ì£ .

ë¹„ìŠ·í•˜ê²Œ `ë¬´í•œ ìŠ¤í¬ë¡¤ë§`ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. íŠ¹ì • ìš”ì†Œë¥¼ ì•„ë˜ì— ë„£ê³ , ê·¸ ìš”ì†Œê°€ ë·°í¬íŠ¸ ì•ˆìœ¼ë¡œ ë“¤ì–´ì˜¤ë©´ ë‹¤ìŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ë©´ ê·¸ê²Œ ë¬´í•œ ìŠ¤í¬ë¡¤ì´ì£ !

> ì €ëŠ” ì¸í„°ë™í‹°ë¸Œ ì›¹ì„ ë§Œë“¤ë•Œ ì¨ë´¤ë„¤ìš”. ê·¸ë•ŒëŠ” ë‹¤ì‹œ ìœ„ë¡œ ìŠ¤í¬ë¡¤í•˜ë©´ ì´ë²¤íŠ¸ë„ ë‹¤ì‹œ í™œì„±í™”í•´ì•¼í•´ì„œ `.unobserve`ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

## 4. ì°¸ê³ ìë£Œ

- [Intersection Observer API](https://developer.mozilla.org/ko/docs/Web/API/Intersection_Observer_API)
- [IntersectionObserverë¥¼ ì´ìš©í•œ ì´ë¯¸ì§€ ë™ì  ë¡œë”© ê¸°ëŠ¥ ê°œì„ ](https://tech.lezhin.com/2017/07/13/intersectionobserver-overview)
