---
import type { CollectionEntry } from "astro:content";
import { getPath } from "@/utils/getPath";
import IconChevronLeft from "@/assets/icons/IconChevronLeft.svg";
import IconChevronRight from "@/assets/icons/IconChevronRight.svg";

export interface Props {
  posts: CollectionEntry<"blog">[];
  currentPostId: string;
}

const { posts, currentPostId } = Astro.props;

/* ========== Prev/Next Posts Logic ========== */

const allPosts = posts.map(({ data: { title }, id, filePath }) => ({
  id,
  title,
  filePath,
}));

const currentPostIndex = allPosts.findIndex(a => a.id === currentPostId);

const prevPost = currentPostIndex !== 0 ? allPosts[currentPostIndex - 1] : null;
const nextPost =
  currentPostIndex !== allPosts.length - 1 ? allPosts[currentPostIndex + 1] : null;
---

<!-- Previous/Next Post Buttons -->
<div data-pagefind-ignore class="grid grid-cols-1 gap-6 sm:grid-cols-2">
  {
    prevPost && (
      <a
        href={getPath(prevPost.id, prevPost.filePath)}
        class="flex w-full gap-1 hover:opacity-75"
      >
        <IconChevronLeft class="inline-block flex-none rtl:rotate-180" />
        <div>
          <span>이전 글</span>
          <div class="text-sm text-accent/85">{prevPost.title}</div>
        </div>
      </a>
    )
  }
  {
    nextPost && (
      <a
        href={getPath(nextPost.id, nextPost.filePath)}
        class="flex w-full justify-end gap-1 text-end hover:opacity-75 sm:col-start-2"
      >
        <div>
          <span>다음 글</span>
          <div class="text-sm text-accent/85">{nextPost.title}</div>
        </div>
        <IconChevronRight class="inline-block flex-none rtl:rotate-180" />
      </a>
    )
  }
</div>