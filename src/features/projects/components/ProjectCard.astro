---
import { Icon } from "astro-icon/components";
import type { Project } from "@/data/projects";

export interface Props {
  project: Project;
  ogImageUrl: string | null;
}

const { project, ogImageUrl } = Astro.props;
const { title, description, githubUrl, liveUrl, techStack, date, featured } =
  project;

const formattedDate = date.toLocaleDateString("ko-KR", {
  year: "numeric",
  month: "long",
});
---

<article
  class="group flex flex-col overflow-hidden rounded-lg border border-border bg-background
         transition-all duration-300
         hover:-translate-y-1 hover:border-accent/50 hover:shadow-lg"
>
  {
    ogImageUrl && (
      <div class="relative aspect-video w-full overflow-hidden">
        <img
          src={ogImageUrl}
          alt={`${title} 프로젝트 미리보기`}
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
          loading="lazy"
        />
        {/* Gradient overlay */}
        <div class="absolute inset-0 bg-linear-to-t from-background/60 via-transparent to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100" />
        {/* Featured badge */}
        {featured && (
          <span class="absolute right-2 top-2 inline-flex items-center gap-1 rounded-full border border-accent/30 bg-background/80 px-2 py-0.5 text-xs font-semibold text-accent backdrop-blur-sm">
            <Icon name="ph:star-fill" size={12} />
            Featured
          </span>
        )}
      </div>
    )
  }
  <div class="flex flex-1 flex-col p-4">
    <h2 class="text-xl font-semibold text-foreground">{title}</h2>
    <p class="mt-2 flex-1 text-sm text-foreground/80">{description}</p>

    <ul class="mt-3 flex flex-wrap gap-2">
      {
        techStack.map(tech => (
          <li class="rounded-full border border-accent/20 bg-accent/5 px-2.5 py-0.5 text-xs font-medium text-accent transition-all duration-200 hover:border-accent/40 hover:bg-accent/15">
            {tech}
          </li>
        ))
      }
    </ul>

    <div class="mt-4 flex items-center justify-between border-t border-border pt-4">
      <div class="flex items-center gap-1 text-xs text-foreground/60">
        <Icon name="ph:calendar-blank" size={14} />
        <span>{formattedDate}</span>
      </div>
      <div class="flex gap-2">
        <a
          href={githubUrl}
          target="_blank"
          rel="noopener noreferrer"
          class="group/btn flex items-center gap-1 rounded-md px-2 py-1 text-sm text-foreground/80
                 transition-all duration-200
                 hover:-translate-y-0.5 hover:bg-accent/10 hover:text-accent"
          aria-label={`${title} GitHub 저장소`}
        >
          <Icon
            name="ph:github-logo"
            size={18}
            class="transition-transform duration-200 group-hover/btn:rotate-12"
          />
          <span class="sr-only sm:not-sr-only">GitHub</span>
        </a>
        {
          liveUrl && (
            <a
              href={liveUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="group/btn flex items-center gap-1 rounded-md px-2 py-1 text-sm text-foreground/80
                     transition-all duration-200
                     hover:-translate-y-0.5 hover:bg-accent/10 hover:text-accent"
              aria-label={`${title} 라이브 데모`}
            >
              <Icon
                name="ph:globe"
                size={18}
                class="transition-transform duration-200 group-hover/btn:rotate-12"
              />
              <span class="sr-only sm:not-sr-only">Live</span>
            </a>
          )
        }
      </div>
    </div>
  </div>
</article>
